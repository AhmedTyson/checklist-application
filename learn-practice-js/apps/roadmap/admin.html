<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Roadmap Content Studio</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
    <style>
      /* --- Admin-Specific Styles --- */
      body {
        overflow: hidden;
        display: flex;
        flex-direction: column;
        background: var(--bg-app);
        height: 100vh;
      }

      /* Header */
      .admin-header {
        height: 60px;
        border-bottom: 1px solid var(--border);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 24px;
        background: var(--bg-sidebar);
        flex-shrink: 0;
      }
      .admin-title h1 {
        margin: 0;
        font-size: 16px;
        color: var(--text-main);
      }
      .admin-title span {
        font-size: 11px;
        color: var(--text-dim);
        margin-left: 8px;
        font-family: var(--font-mono);
      }

      /* Main Body */
      .admin-body {
        flex: 1;
        display: flex;
        overflow: hidden;
      }

      /* Editor Pane (Left) */
      .editor-pane {
        width: 450px;
        overflow-y: auto;
        border-right: 1px solid var(--border);
        background: var(--bg-app);
        padding: 24px;
        display: flex;
        flex-direction: column;
        gap: 24px;
        flex-shrink: 0;
      }

      .section-group {
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 16px;
        background: var(--bg-panel);
      }

      .section-title {
        font-size: 12px;
        font-weight: 600;
        color: var(--text-main);
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .section-title::before {
        content: "";
        width: 4px;
        height: 12px;
        background: var(--accent);
        border-radius: 2px;
      }

      .form-label {
        display: block;
        margin-bottom: 6px;
        font-size: 11px;
        color: var(--text-muted);
        font-weight: 500;
      }

      .input-text,
      .input-area {
        width: 100%;
        background: var(--bg-app);
        border: 1px solid var(--border);
        padding: 10px;
        color: var(--text-main);
        border-radius: 6px;
        font-family: var(--font-ui);
        font-size: 13px;
        transition: border 0.2s;
      }

      .input-text:focus,
      .input-area:focus {
        outline: none;
        border-color: var(--accent);
      }

      .input-area {
        min-height: 80px;
        resize: vertical;
        line-height: 1.5;
      }

      .code-area {
        font-family: var(--font-mono);
        font-size: 12px;
        color: var(--text-muted);
        background: #000;
        min-height: 120px;
      }

      .btn-primary,
      .btn-secondary,
      .btn-danger {
        padding: 8px 16px;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
        border: none;
        font-size: 12px;
        transition: opacity 0.2s;
      }
      .btn-primary {
        background: var(--accent);
        color: white;
      }
      .btn-secondary {
        background: var(--bg-panel);
        border: 1px solid var(--border);
        color: var(--text-main);
      }
      .btn-danger {
        background: transparent;
        border: 1px solid var(--border);
        color: var(--danger);
      }

      .btn-block {
        width: 100%;
        display: block;
        margin-top: 8px;
      }
      .btn-primary:hover,
      .btn-secondary:hover,
      .btn-danger:hover {
        opacity: 0.9;
      }

      /* Preview Pane (Right) */
      .preview-container {
        flex: 1;
        background: #000;
        display: flex;
        flex-direction: column;
        position: relative;
      }

      .preview-toolbar {
        height: 48px;
        border-bottom: 1px solid var(--border);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 24px;
        background: var(--bg-panel);
      }

      .toggle-group {
        display: flex;
        gap: 4px;
        background: var(--bg-app);
        padding: 4px;
        border-radius: 6px;
        border: 1px solid var(--border);
      }

      .toggle-btn {
        padding: 6px 12px;
        border: none;
        background: transparent;
        color: var(--text-dim);
        font-size: 11px;
        font-weight: 600;
        cursor: pointer;
        border-radius: 4px;
      }
      .toggle-btn.active {
        background: var(--bg-active);
        color: var(--text-main);
      }

      .preview-content-wrapper {
        flex: 1;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 48px;
        background-image: radial-gradient(var(--border) 1px, transparent 1px);
        background-size: 20px 20px;
      }

      .device-mockup {
        width: 400px;
        height: 100%;
        max-height: 800px;
        background: var(--bg-panel);
        border: 1px solid var(--border);
        border-radius: 12px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      .preview-header-mock {
        padding: 24px;
        border-bottom: 1px solid var(--border);
        background: var(--bg-sidebar);
      }

      .source-view {
        display: none;
        flex: 1;
        position: relative;
      }
      .source-view.visible {
        display: block;
      }

      #code-output {
        width: 100%;
        height: 100%;
        border: none;
        padding: 24px;
        resize: none;
        background: #0d0d0d;
        color: #a9b7c6;
        font-family: var(--font-mono);
        font-size: 13px;
      }

      /* Tree View Styles */
      .tree-root {
        margin-bottom: 24px;
      }
      .tree-stage {
        border: 1px solid var(--border);
        border-radius: 6px;
        margin-bottom: 8px;
        overflow: hidden;
      }
      .tree-stage-header {
        padding: 10px;
        background: var(--bg-sidebar);
        display: flex;
        justify-content: space-between;
        align-items: center;
        cursor: pointer;
        font-weight: 600;
        font-size: 12px;
        border-bottom: 1px solid var(--border);
      }
      .tree-items {
        display: none;
        background: var(--bg-app);
      }
      .tree-items.expanded {
        display: block;
      }
      .tree-item {
        padding: 8px 12px;
        border-bottom: 1px solid var(--border);
        font-size: 12px;
        display: flex;
        justify-content: space-between;
        cursor: pointer;
        padding-left: 24px;
      }
      .tree-item:last-child {
        border-bottom: none;
      }
      .tree-item:hover {
        background: var(--bg-active);
      }
      .tree-item.active {
        background: var(--bg-active);
        color: var(--accent);
      }

      .icon-action {
        background: transparent;
        border: none;
        color: var(--text-dim);
        cursor: pointer;
        padding: 2px 4px;
        border-radius: 4px;
      }
      .icon-action:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--text-main);
      }
      .icon-danger:hover {
        color: var(--danger);
      }

      .hidden {
        display: none !important;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header class="admin-header">
      <div class="admin-title">
        <h1>Roadmap Content Studio</h1>
        <span>v3.0 (Rebuilt)</span>
      </div>
      <div class="actions">
        <button id="btn-copy-json" class="btn-primary">Copy All JSON</button>
      </div>
    </header>

    <div class="admin-body">
      <!-- Left: Editor & Tree -->
      <aside class="editor-pane">
        <!-- Tree View -->
        <div class="section-group">
          <div class="section-title">
            Content Structure
            <button id="btn-new-stage" class="icon-action" title="Add Stage">
              +
            </button>
          </div>
          <input
            type="text"
            id="inp-search-tree"
            class="input-text"
            placeholder="Search items..."
            style="margin-bottom: 12px; font-size: 12px; padding: 6px 8px"
          />
          <div id="tree-root" class="tree-root">
            <!-- Dynamic Tree Content -->
          </div>
        </div>

        <!-- Item Editor -->
        <div id="item-editor" class="section-group hidden">
          <div class="section-title">Edit Item</div>

          <label class="form-label">Title</label>
          <input
            type="text"
            id="inp-title"
            class="input-text"
            placeholder="Item Title"
          />
          <br /><br />

          <label class="form-label">Description</label>
          <input
            type="text"
            id="inp-desc"
            class="input-text"
            placeholder="Short description"
          />
          <br /><br />

          <label class="form-label">Explanation</label>
          <textarea
            id="inp-expl"
            class="input-area"
            placeholder="Detailed explanation markdown..."
          ></textarea>
          <br /><br />

          <label class="form-label">Code Snippet</label>
          <textarea
            id="inp-code"
            class="input-area code-area"
            placeholder="// Code example..."
          ></textarea>
          <br /><br />

          <label class="form-label">Challenge Prompt</label>
          <textarea
            id="inp-prompt"
            class="input-area"
            placeholder="Challenge for the user..."
          ></textarea>
          <br /><br />

          <label class="form-label">Resources</label>
          <div
            id="resources-list"
            style="
              display: flex;
              flex-direction: column;
              gap: 8px;
              margin-bottom: 8px;
            "
          >
            <!-- Dynamic Rows -->
          </div>
          <button
            id="btn-add-resource"
            class="btn-secondary"
            style="width: 100%; font-size: 11px"
          >
            + Add Resource
          </button>

          <div style="margin-top: 16px; display: flex; gap: 8px">
            <button id="btn-save-item" class="btn-primary" style="flex: 1">
              Save Changes
            </button>
            <button id="btn-delete-item" class="btn-danger">Delete</button>
          </div>
        </div>

        <!-- Empty State Message -->
        <div id="editor-empty" class="section-group">
          <p
            style="text-align: center; color: var(--text-dim); font-size: 12px"
          >
            Select an item to edit or create a new stage.
          </p>
        </div>
      </aside>

      <!-- Right: Preview -->
      <main class="preview-container">
        <div class="preview-toolbar">
          <div class="toggle-group">
            <button
              id="btn-view-visual"
              class="toggle-btn active"
              data-view="visual"
            >
              Visual
            </button>
            <button id="btn-view-edit" class="toggle-btn" data-view="edit">
              Edit
            </button>
            <button id="btn-view-source" class="toggle-btn" data-view="source">
              JSON
            </button>
          </div>
        </div>

        <!-- Visual View -->
        <div id="view-visual" class="preview-content-wrapper">
          <div class="device-mockup">
            <div class="preview-header-mock">
              <h2 id="prev-title">Item Title</h2>
            </div>
            <div class="scroll-body" style="padding: 24px">
              <p
                id="prev-desc"
                style="
                  color: var(--text-dim);
                  font-size: 14px;
                  margin-bottom: 16px;
                "
              >
                Description...
              </p>
              <div
                id="prev-content"
                style="
                  font-size: 13px;
                  line-height: 1.6;
                  color: var(--text-muted);
                "
              >
                <!-- Dynamic Preview -->
              </div>
            </div>
          </div>
        </div>

        <!-- Edit View -->
        <div
          id="view-edit"
          class="source-view"
          style="padding: 40px; overflow-y: auto; background: var(--bg-app)"
        >
          <div
            id="item-editor"
            class="hidden"
            style="max-width: 600px; margin: 0 auto"
          >
            <div class="section-title">Edit Item Content</div>

            <label class="form-label">Title</label>
            <input
              type="text"
              id="inp-title"
              class="input-text"
              placeholder="Item Title"
            />
            <br /><br />

            <label class="form-label">Description</label>
            <input
              type="text"
              id="inp-desc"
              class="input-text"
              placeholder="Short description"
            />
            <br /><br />

            <label class="form-label">Explanation</label>
            <textarea
              id="inp-expl"
              class="input-area"
              placeholder="Detailed explanation markdown..."
            ></textarea>
            <br /><br />

            <label class="form-label">Code Snippet</label>
            <textarea
              id="inp-code"
              class="input-area code-area"
              placeholder="// Code example..."
            ></textarea>
            <br /><br />

            <label class="form-label">Challenge Prompt</label>
            <textarea
              id="inp-prompt"
              class="input-area"
              placeholder="Challenge for the user..."
            ></textarea>
            <br /><br />

            <label class="form-label">Resources</label>
            <div
              id="resources-list"
              style="
                display: flex;
                flex-direction: column;
                gap: 8px;
                margin-bottom: 8px;
              "
            >
              <!-- Dynamic Rows -->
            </div>
            <button
              id="btn-add-resource"
              class="btn-secondary"
              style="width: 100%; font-size: 11px"
            >
              + Add Resource
            </button>

            <div
              style="
                margin-top: 32px;
                display: flex;
                gap: 12px;
                border-top: 1px solid var(--border);
                padding-top: 24px;
              "
            >
              <button
                id="btn-save-item"
                class="btn-primary"
                style="flex: 1; padding: 12px"
              >
                Save Changes
              </button>
              <button
                id="btn-delete-item"
                class="btn-danger"
                style="padding: 12px"
              >
                Delete Item
              </button>
            </div>
          </div>

          <div
            id="editor-empty"
            class="section-group"
            style="text-align: center; padding: 40px"
          >
            <p style="color: var(--text-dim)">
              Select an item from the sidebar to edit.
            </p>
          </div>
        </div>

        <!-- Source View -->
        <div id="view-source" class="source-view">
          <textarea id="code-output" spellcheck="false"></textarea>
          <button
            id="btn-apply-source"
            class="btn-primary"
            style="position: absolute; bottom: 24px; right: 24px"
          >
            Apply & Save
          </button>
        </div>
      </main>
    </div>

    <script type="module" src="admin.js"></script>
  </body>
</html>
