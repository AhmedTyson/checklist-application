<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Roadmap Content Studio</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="src/app/styles/main.css" />
    <link rel="stylesheet" href="src/admin/styles/admin.css" />
    <link rel="stylesheet" href="src/shared/loader/loader.css" />
  </head>
  <body>
    <!-- Global Loader -->
    <div id="global-loader">
      <div class="loader-spinner"></div>
    </div>
    <script src="src/shared/loader/loader.js"></script>

    <!-- Header -->
    <header class="admin-header">
      <div class="admin-title">
        <h1>Roadmap Content Studio</h1>
        <span>v3.0 (Rebuilt)</span>
      </div>
      <div class="actions" style="display: flex; gap: 8px">
        <a
          href="index.html"
          class="icon-btn"
          title="Back to App"
          style="text-decoration: none; border: 1px solid var(--border)"
        >
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
          </svg>
        </a>
        <button id="btn-copy-json" class="icon-btn" title="Copy Key">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
            <path
              d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"
            ></path>
          </svg>
        </button>
      </div>
    </header>

    <div class="admin-body">
      <!-- Left: Editor & Tree -->
      <aside class="editor-pane">
        <!-- Tree View -->
        <div class="section-group">
          <div class="section-title">
            Content Structure
            <button id="btn-new-stage" class="icon-btn" title="Add Stage">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
            </button>
          </div>
          <input
            type="text"
            id="inp-search-tree"
            class="input-text"
            placeholder="Search items..."
            style="margin-bottom: 12px; font-size: 12px; padding: 6px 8px"
          />
          <div id="tree-root" class="tree-root">
            <!-- Dynamic Tree Content -->
          </div>
        </div>

        <!-- Editor moved to Main View -->
      </aside>

      <!-- Right: Preview -->
      <main class="preview-container">
        <div class="preview-toolbar">
          <div class="toggle-group">
            <button
              id="btn-view-visual"
              class="toggle-btn active"
              data-view="visual"
            >
              Visual
            </button>
            <button id="btn-view-edit" class="toggle-btn" data-view="edit">
              Edit
            </button>
            <button id="btn-view-source" class="toggle-btn" data-view="source">
              JSON
            </button>
          </div>
        </div>

        <!-- Visual View -->
        <div id="view-visual" class="preview-content-wrapper">
          <div class="device-mockup">
            <div class="preview-header-mock">
              <h2 id="prev-title">Item Title</h2>
            </div>
            <div class="scroll-body" style="padding: 24px">
              <p
                id="prev-desc"
                style="
                  color: var(--text-dim);
                  font-size: 14px;
                  margin-bottom: 16px;
                "
              >
                Description...
              </p>
              <div
                id="prev-content"
                style="
                  font-size: 13px;
                  line-height: 1.6;
                  color: var(--text-muted);
                "
              >
                <!-- Dynamic Preview -->
              </div>
            </div>
          </div>
        </div>

        <!-- Edit View -->
        <div
          id="view-edit"
          class="source-view"
          style="
            padding: 40px;
            overflow-y: auto;
            background: var(--bg-app);
            display: none;
          "
        >
          <div
            id="item-editor"
            class="hidden"
            style="max-width: 600px; margin: 0 auto"
          >
            <div class="section-title">Edit Item Content</div>

            <label class="form-label">Title</label>
            <input
              type="text"
              id="inp-title"
              class="input-text"
              placeholder="Item Title"
            />
            <br /><br />

            <label class="form-label">Description</label>
            <input
              type="text"
              id="inp-desc"
              class="input-text"
              placeholder="Short description"
            />
            <br /><br />

            <label class="form-label">Explanation</label>
            <textarea
              id="inp-expl"
              class="input-area"
              placeholder="Detailed explanation markdown..."
            ></textarea>
            <br /><br />

            <label class="form-label">Code Snippet</label>
            <textarea
              id="inp-code"
              class="input-area code-area"
              placeholder="// Code example..."
            ></textarea>
            <br /><br />

            <label class="form-label">Challenge Prompt</label>
            <textarea
              id="inp-prompt"
              class="input-area"
              placeholder="Challenge for the user..."
            ></textarea>
            <br /><br />

            <label class="form-label">Resources</label>
            <div
              id="resources-list"
              style="
                display: flex;
                flex-direction: column;
                gap: 8px;
                margin-bottom: 8px;
              "
            >
              <!-- Dynamic Rows -->
            </div>
            <button
              id="btn-add-resource"
              class="btn-secondary"
              style="
                width: 100%;
                font-size: 11px;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 6px;
              "
            >
              <svg
                width="12"
                height="12"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              Add Resource
            </button>

            <div
              style="
                margin-top: 32px;
                display: flex;
                gap: 12px;
                border-top: 1px solid var(--border);
                padding-top: 24px;
              "
            >
              <button
                id="btn-save-item"
                class="btn-primary"
                style="
                  flex: 1;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  gap: 8px;
                "
              >
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path
                    d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"
                  ></path>
                  <polyline points="17 21 17 13 7 13 7 21"></polyline>
                  <polyline points="7 3 7 8 15 8"></polyline>
                </svg>
                Save
              </button>
              <button
                id="btn-delete-item"
                class="btn-danger"
                style="
                  padding: 12px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                "
              >
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <polyline points="3 6 5 6 21 6"></polyline>
                  <path
                    d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
                  ></path>
                </svg>
              </button>
            </div>
          </div>

          <div
            id="editor-empty"
            class="section-group"
            style="text-align: center; padding: 40px"
          >
            <p style="color: var(--text-dim)">
              Select an item from the sidebar to edit.
            </p>
          </div>
        </div>

        <!-- Source View -->
        <div id="view-source" class="source-view">
          <textarea id="code-output" spellcheck="false"></textarea>
          <button
            id="btn-apply-source"
            class="btn-primary"
            style="position: absolute; bottom: 24px; right: 24px"
          >
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path
                d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"
              ></path>
              <polyline points="17 21 17 13 7 13 7 21"></polyline>
              <polyline points="7 3 7 8 15 8"></polyline>
            </svg>
            Apply & Save
          </button>
        </div>
      </main>
    </div>

    <script type="module" src="src/admin/App.js"></script>
  </body>
</html>
